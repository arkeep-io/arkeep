services:
  server:
    image: ghcr.io/arkeep/arkeep-server:latest
    container_name: arkeep-server
    restart: unless-stopped
    ports:
      - "${ARKEEP_HTTP_PORT:-8080}:8080"
      - "${ARKEEP_GRPC_PORT:-9090}:9090"
    environment:
      ARKEEP_SECRET_KEY: "${ARKEEP_SECRET_KEY:?ARKEEP_SECRET_KEY is required â€” generate with: openssl rand -hex 32}"
      ARKEEP_DB_DRIVER: "${ARKEEP_DB_DRIVER:-sqlite}"
      ARKEEP_DB_DSN: "${ARKEEP_DB_DSN:-/var/lib/arkeep/arkeep.db}"
      ARKEEP_LOG_LEVEL: "${ARKEEP_LOG_LEVEL:-info}"
      ARKEEP_HTTP_ADDR: ":8080"
      ARKEEP_GRPC_ADDR: ":9090"
    volumes:
      - arkeep-data:/var/lib/arkeep
    healthcheck:
      test: ["CMD", "wget", "--quiet", "--tries=1", "--spider", "http://localhost:8080/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

volumes:
  arkeep-data:
    driver: local